<div class="container-fluid">
  <div class="row">
    <div class="col col-sm-3 side-nav">
      <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">

        <a *ngIf="user.email" class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab"
          aria-controls="v-pills-profile" aria-selected="true">{{user.email}} <i class="fas fa-cog"></i></a>

        <a *ngIf="user.isAdmin" class="nav-link" id="v-pills-admin-tab" data-toggle="pill" href="#v-pills-admin" role="tab"
          aria-controls="v-pills-admin" aria-selected="true">Admin Dashboard</a>

        <hr>

        <ng-container *ngFor="let base of user.bases; let isFirst = first">

          <!-- If the user is a base manager -->
          <ng-container *ngIf="base.canCreateOrgs || user.isAdmin">
              <a class="nav-link" id="v-pills-{{base.baseId}}-tab" data-toggle="pill" href="#v-pills-{{base.baseId}}" role="tab" attr.aria-controls="v-pills-{{base.baseId}}" aria-selected="true">
                <span class="base-name">{{ base.baseName }}</span>
                <span class="base-phone-number">{{ toPrettyPhone(base.basePhoneNumber) }}</span>
              </a>
          </ng-container>

          <!-- If the user is not a base manager -->
          <ng-container *ngIf="!base.canCreateOrgs">
              <span class="base-name">{{ base.baseName }}</span>
              <span class="base-phone-number" id="{{base.basePhoneNumber}}">{{ toPrettyPhone(base.basePhoneNumber) }}</span>
          </ng-container>

          <!-- List orgs managed by user -->
          <ng-container *ngFor="let org of base.orgs">
              <a [class.active]="isFirst" class="nav-link" id="v-pills-{{base.baseId}}-{{org.orgId}}-tab" data-toggle="pill" href="#v-pills-{{base.baseId}}-{{org.orgId}}" role="tab" attr.aria-controls="v-pills-{{base.baseId}}-{{org.orgId}}" aria-selected="true">{{org.orgName}}</a>
          </ng-container>

        </ng-container>
     
     </div>
    </div>
    <div class="col col-sm-9 dashboard">
      <div class="tab-content" id="v-pills-tabContent">

        <div class="tab-pane fade show" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
          <pre>{{user | json}}</pre>
        </div>

        <div *ngIf="admin" class="tab-pane fade show" id="v-pills-admin" role="tabpanel" aria-labelledby="v-pills-admin-tab">
          <pre>{{ admin | json}}</pre>
        </div>

        <ng-container *ngFor="let base of user.bases; let isFirst = first">

          <!-- Create Base Manager dashboard -->
          <ng-container *ngIf="base.canCreateOrgs || user.isAdmin">
            
              <div class="tab-pane fade show" id="v-pills-{{base.baseId}}" role="tabpanel" attr.aria-labelledby="v-pills-{{base.baseId}}-tab">
                {{base.basePhoneNumber}}
              </div>
            
          </ng-container>

          <!-- Create org dashboards -->
          <ng-container *ngFor="let org of base.orgs">

            <div [class.active]="isFirst" class="tab-pane fade show" id="v-pills-{{base.baseId}}-{{org.orgId}}" role="tabpanel" attr.aria-labelledby="v-pills-{{base.baseId}}-{{org.orgId}}-tab">
              <!-- This part of the dashboard will show for all managers -->
              {{org.subscriptionCode}}

              <!-- This part of the dashboard will only show for orgOwners NOT admins, to curb confusion. -->
            </div>

          </ng-container>

        </ng-container>

      </div>
    </div>
  </div>
</div>